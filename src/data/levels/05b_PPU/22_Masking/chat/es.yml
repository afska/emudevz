main:
  messages:
  - el registro de video ğŸ­  PPUMask ($2001) permite a los programas habilitar o deshabilitar partes del renderizado
  - revisa nuevamente ğŸ“„  ~/docs/ppu/video_registers.es.md~
  - ğŸ›ï¸  los bits ~m~ y ~M~ controlan si la primera columna de ~8~px debe ser visible o no para el fondo y sprites respectivamente
  - ğŸï¸  ~b~ habilita el renderizado del fondo
  - ğŸ›¸  y ~s~ habilita el renderizado de sprites
  responses:
  - (*) Â¿por quÃ© un juego querrÃ­a deshabilitar el renderizado? [why]
  - hagÃ¡moslo [exercise]

why:
  messages:
  - por ejemplo, para llenar la VRAM mÃ¡s rÃ¡pido usando el tiempo de VDraw, ocultando posibles glitches que puedan surgir de no hacerlo en ğŸï¸  VBlank
  - los juegos normalmente escriben $00 fuera del gameplay para hacer eso
  - y luego $1E para habilitar el renderizado durante el gameplay
  responses:
  - ...main

exercise:
  messages:
  - ğŸ“š  en ğŸ­  `PPUMask`, implementa el mÃ©todo `onLoad()`, usando `addField(...)` para mapear los bits mencionados
  - |-
    usa estos nombres:
      - `showBackgroundInFirst8Pixels`
      - `showSpritesInFirst8Pixels`
      - `showBackground`
      - `showSprites`
  - |-
    ğŸ“š  ademÃ¡s, agrega estos mÃ©todos:
      **onWrite(value)**:
        **->** llama a ```javascript this.setValue(value)```
      **isRenderingEnabled()**:
        **->** devuelve ```javascript this.showBackground || this.showSprites```
  - |-
    ğŸ“š  en ğŸï¸  `BackgroundRenderer`, <cambia>:
      **renderScanline()**:
        **->** si (`showBackground` estÃ¡ apagada) <OR> (`showBackgroundInFirst8Pixels` estÃ¡ apagada y `x < 8`)
          **->** solo dibuja (con `PPU::plotBG(...)`) el color de fondo
          **->** incrementa `x`
          **->** Â¡`continue`! Â¡no proceses mÃ¡s!
        (recuerda que el color de fondo es ```javascript this.ppu.getColor(0, 0)```)
  - |-
    ğŸ“š  en ğŸ›¸  `SpriteRenderer`, <cambia> los siguientes mÃ©todos:
      **renderScanline()**:
        **->** en la primera lÃ­nea, si `showSprites` estÃ¡ apagada, Â¡retorna! Â¡<no hagas nada>!
      **_render(...)**:
        **->** aplica una lÃ³gica similar:
          ```javascript if (!showSprites || (!showSpritesInFirst8Pixels && x < 8))
            continue;```
      **->** en la comprobaciÃ³n de sprite-zero hit, agrega tanto `showBackground` como `showSprites` como condiciones
        (si una de ellos es `false`, Â¡no se debe disparar ningÃºn sprite-zero hit!)
  - |-
    ğŸ“š  en ğŸ–¥ï¸  `PPU`, cambia:
    **_onPreLine()**:
      **->** en la primera lÃ­nea, si `!isRenderingEnabled()` en ğŸ­  PPUMask, Â¡retorna!
    **_onVisibleLine()**:
      **->** en la <Ãºltima lÃ­nea>, si `!isRenderingEnabled()` en ğŸ­  PPUMask, Â¡retorna!
      **->** tu cÃ³digo deberÃ­a verse asÃ­:
        ```javascript
        if (this.cycle === 0) {
          // render background
          // render sprites
        }
        
        if (!this.registers.ppuMask.isRenderingEnabled()) return;
        
        // <<Â¡agregaremos mÃ¡s cÃ³digo aquÃ­ despuÃ©s!>>```
  responses: []
