main:
  messages:
  - el registro de video ğŸ­  PPUMask ($2001) permite a los programas habilitar o deshabilitar partes de la renderizaciÃ³n
  - revisa nuevamente ğŸ“„  ~/docs/ppu/video_registers.es.md~
  - ğŸ›ï¸  los bits ~m~ y ~M~ controlan si la primera columna de 8px debe ser visible o no para los fondos y sprites respectivamente
  - ğŸï¸  ~b~ habilita la renderizaciÃ³n de fondos
  - ğŸ›¸  y ~s~ habilita la renderizaciÃ³n de sprites
  responses:
  - (*) Â¿por quÃ© un juego querrÃ­a deshabilitar la renderizaciÃ³n? [why]
  - hagÃ¡moslo [lets]

why:
  messages:
  - por ejemplo, para llenar VRAM mÃ¡s rÃ¡pido usando el tiempo de VDraw, ocultando posibles glitches resultado de no hacerlo en ğŸï¸  VBlank
  - los juegos tÃ­picamente escriben $00 fuera de gameplay para hacer eso
  - y luego $1E para habilitar la renderizaciÃ³n durante el gameplay
  responses:
  - ...main

lets:
  messages:
  - ğŸ“š  en `PPUMask`, implementa el mÃ©todo `onLoad()`, usando `addField(...)` para mapear los bits mencionados
  - |-
    usa estos nombres:
      `showBackgroundInFirst8Pixels`
      `showSpritesInFirst8Pixels`
      `showBackground`
      `showSprites`
  - |-
    ğŸ“š  tambiÃ©n, agrega estos mÃ©todos:
      **onWrite(value)**:
        **->** llama a ```javascript this.setValue(value)```
      **isRenderingEnabled()**:
        **->** retorna ```javascript this.showBackground || this.showSprites```
  - |-
    ğŸ“š  en `PPU`, quieres <no hacer nada> si la renderizaciÃ³n estÃ¡ deshabilitada:
      ```javascript if (!this.registers.ppuMask.isRenderingEnabled())
        return;```
    agrega eso al comienzo de `onPreLine(...)` y `onVisibleLine(...)`!
  - |-
    ğŸ“š  solo llama a `BackgroundRenderer::renderScanline` si `showBackground` estÃ¡ habilitado,
    y solo llama a `SpriteRenderer::renderScanline` si `showSprites` estÃ¡ habilitado
  responses:
  - Â¿no deberÃ­a tambiÃ©n cambiar los renderizadores? [renderers]

renderers:
  messages:
  - yep, veamos...
  - |-
    ğŸ“š  en `BackgroundRenderer`, cambia `renderScanline()`:
    si `showBackgroundInFirst8Pixels` estÃ¡ apagado y `x < 8`, solo dibuja (con `PPU::plotBG(...)`) el color de fondo, incrementa `x` y despuÃ©s haz `continue`! Â¡no proceses mÃ¡s!
    (recuerda que el color de fondo es ```javascript this.ppu.getColor(0, 0)```)
  - |-
    ğŸ“š  en `SpriteRenderer`, cambia `_render(...)`...
    necesitas una lÃ³gica similar:
    ```javascript if (!this.ppu.registers.ppuMask.showSpritesInFirst8Pixels && x < 8)
      continue;```
    en el `if` del sprite-zero hit, agrega `showBackground` y `showSprites` como condiciones: si uno de ellos estÃ¡ deshabilitado, Â¡no deberÃ­a activarse!
  responses: []
