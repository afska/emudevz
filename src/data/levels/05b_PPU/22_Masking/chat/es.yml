main:
  messages:
  - el registro de video ğŸ­  ~PPUMask~ ($2001) permite a los programas habilitar o deshabilitar partes de la renderizaciÃ³n
  - revisa nuevamente ğŸ“„  ~/docs/ppu/video_registers.en.md~
  - ğŸ›ï¸  los bits ~m~ y ~M~ controlan si la primera columna de 8px debe ser visible o no para los fondos y sprites respectivamente
  - ğŸï¸  ~b~ habilita la renderizaciÃ³n de fondos
  - ğŸ›¸  y ~s~ habilita la renderizaciÃ³n de sprites
  responses:
  - (*) Â¿por quÃ© un juego querrÃ­a deshabilitar la renderizaciÃ³n? [why]
  - hagÃ¡moslo [lets]

why:
  messages:
  - por ejemplo, para llenar VRAM mÃ¡s rÃ¡pido usando el tiempo de VDraw, ocultando posibles glitches resultado de no hacerlo en ğŸï¸  VBlank
  - los juegos tÃ­picamente escriben $00 fuera de gameplay para hacer eso
  - y luego $1E para habilitar la renderizaciÃ³n durante el gameplay
  responses:
  - ...main

lets:
  messages:
  - ğŸ“š  _-_en `PPUMask`, implementa el mÃ©todo `onLoad()`, usando `addField(...)` para mapear los bits mencionados_--_
  - |-
    _-_usa estos nombres:_--_
      _-_`showBackgroundInFirst8Pixels`_--_
      _-_`showSpritesInFirst8Pixels`_--_
      _-_`showBackground`_--_
      _-_`showSprites`_--_
  - |-
    ğŸ“š  _-_tambiÃ©n, agrega estos mÃ©todos:_--_
      *_-_*onWrite(value)**:_--_
        *_-_*->** llama a ~this.setValue(value)~_--_
      *_-_*isRenderingEnabled()**:_--_
        *_-_*->** retorna ~this.showBackground || this.showSprites~_--_
  - |-
    ğŸ“š  _-_en `PPU`, quieres <no hacer nada> si la renderizaciÃ³n estÃ¡ deshabilitada:_--_
      _-_```javascript if (!this.registers.ppuMask.isRenderingEnabled())
        return;```_--_
    _-_agrega eso al comienzo de `onPreLine` y `onVisibleLine`!_--_
  - |-
    ğŸ“š  _-_solo llama a `BackgroundRenderer::renderScanline` si `showBackground` estÃ¡ habilitado,_--_
    _-_y solo llama a `SpriteRenderer::renderScanline` si `showSprites` estÃ¡ habilitado_--_
  responses:
  - Â¿no deberÃ­a tambiÃ©n cambiar los renderizadores? [renderers]

renderers:
  messages:
  - yep, veamos...
  - |-
    ğŸ“š  _-_en `BackgroundRenderer`, cambia `renderScanline()`:_--_
    _-_si `showBackgroundInFirst8Pixels` estÃ¡ apagado y `x < 8`, solo dibuja el color de fondo, incrementa ~x~ y despuÃ©s haz ~continue~! Â¡no proceses mÃ¡s!_--_
    _-_(recuerda que el color de fondo es `this.ppu.getColor(0, 0)`)_--_
  - |-
    ğŸ“š  _-_en `SpriteRenderer`, cambia `_render(...)`..._--_
    _-_necesitas una lÃ³gica similar:_--_
    _-_```javascript if (!this.ppu.registers.ppuMask.showSpritesInFirst8Pixels && x < 8)
      continue;```_--_
    _-_en el `if` del sprite-0 hit, agrega `showBackground` y `showSprites` como condiciones: si uno de ellos estÃ¡ deshabilitado, Â¡no deberÃ­a activarse!_--_
  responses: []
