main:
  messages:
  - Â¡sÃ­!
  - acabo de terminarlo
  - mira, ğŸ“„  ~/lib/ppu/LoopyRegister.js~
  responses:
  - Â¿quiÃ©n es loopy? [loopy]

loopy:
  messages:
  - un usuario que realizÃ³ ingenierÃ­a inversa para descubrir cÃ³mo <realmente> funciona el registro de scrolling de la PPU
  - la triste verdad es...
  - el scrolling de la PPU no funciona como lo tenemos implementado ahora mismo ğŸ˜…
  - es mucho mÃ¡s complicado que eso
  - afortunadamente, con mi cÃ³digo, puedes implementar el desplazamiento HaciÃ©ndolo Bienâ„¢ âœ¨
  responses:
  - Â¿quÃ© necesitamos cambiar? [exercise]

exercise:
  messages:
  - |-
    ğŸ“š  importa la biblioteca y agrega una propiedad `loopy` en el constructor de ğŸ–¥ï¸  `PPU`, asignada a:
      ```javascript new LoopyRegister()```
  - |-
    ğŸ“š  al final del mÃ©todo `_onPreLine()`, llama a:
      ```javascript this.loopy.onPreLine(this.cycle);```
  - |-
    ğŸ“š  al final del mÃ©todo `_onVisibleLine()`, llama a:
      ```javascript this.loopy.onVisibleLine(this.cycle);```
  - |-
    ğŸ“š  al final del mÃ©todo `plotBG(...)`, llama a:
      ```javascript if (this.registers.ppuMask.showBackground)
        this.loopy.onPlot(x);```
  - |-
    ğŸ“š  en ğŸ›ï¸  `PPUCtrl`, elimina el campo `nameTableId`; reemplaza su asignaciÃ³n en el mÃ©todo `onWrite(...)` con:
      ```javascript this.ppu.loopy.onPPUCtrlWrite(value);```
  - |-
    ğŸ“š  en ğŸ“Š  `PPUStatus`, reemplaza el cÃ³digo que desactiva el `latch` de ğŸ“  `PPUAddr` con:
      ```javascript this.ppu.loopy.onPPUStatusRead();```
  - |-
    ğŸ“š  en ğŸ“œ  `PPUScroll`, elimina el mÃ©todo `onLoad()` y reemplaza `onWrite(...)` con:
      ```javascript onWrite(value) {
        this.ppu.loopy.onPPUScrollWrite(value);
      }```
  - |-
    ğŸ“š  en ğŸ“  `PPUAddr`, elimina el mÃ©todo `onLoad()` y reemplaza `onWrite(...)` con:
      ```javascript onWrite(value) {
        this.ppu.loopy.onPPUAddrWrite(value);
      }```
    ademÃ¡s, agrega esta propiedad dinÃ¡mica:
      ```javascript get address() {
        return this.ppu.loopy.vAddress.getValue()
      }

      set address(value) {
        this.ppu.loopy.vAddress.setValue(value);
      }```
  - |-
    ğŸ“š  por Ãºltimo, en ğŸï¸  `BackgroundRenderer`, remplaza las constantes `scrolledX`, `scrolledY` and `nameTableId` con:
      ```javascript const scrolledX = this.ppu.loopy.scrolledX(x);
      const scrolledY = this.ppu.loopy.scrolledY(y);
      const nameTableId = this.ppu.loopy.nameTableId(scrolledX);```
  responses: []

corollary:
  messages:
  - estÃ¡ bien...
  - el scrolling ahora deberÃ­a funcionar en todos los juegos, en todos los casos
  - supongo...
  - espero ğŸ˜…
  responses:
  - â–¶ï¸  continuar [end]
