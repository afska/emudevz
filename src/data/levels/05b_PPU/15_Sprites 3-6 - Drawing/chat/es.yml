main:
  messages:
  - ya que ya sabemos quÃ© sprites necesitamos dibujar y cÃ³mo renderizar los tiles,
  - dibujar sprites serÃ¡ bastante <fÃ¡cil>
  - |-
    nuestro mÃ©todo para renderizar una sola ğŸŒ   scanline se verÃ¡ asÃ­:
      ```javascript
      renderScanline() {
        const sprites = this._evaluate();
        this._render(sprites); // Â¡necesitamos definir esto!
      }```
  responses:
  - fÃ¡cil... Â¿eh? [easy]

easy:
  messages:
  - vamos a hacer lo siguiente
  - |-
      ğŸ“š  en la clase ğŸ–¥ï¸  `PPU`, cambia:
      **_onVisibleLine()**:
        **->** justo debajo de la llamada `renderScanline()` a `backgroundRenderer`...
        **->** ...haz lo mismo con `spriteRenderer`
  - |-
      ğŸ“š  implementa estos mÃ©todos en ğŸ›¸  `SpriteRenderer`:
      **renderScanline()**:
        **->** Â¡usa el cÃ³digo de mi mensaje anterior!
      **_render(sprites)**:
        **->** determina la coordenada y:
          ```javascript this.ppu.scanline;```
          (llamemos a esto `y`)
        **->** para cada `sprite` en `sprites`:
          **->** calcula la coordenada Y "interna":
            ```javascript sprite.diffY(y)```
            (llamemos a esto `insideY`)
          **->** instancia un ğŸ•Šï¸  `Tile` pasando la ppu, el id de la pattern table, el id del tile y el `insideY`
            (llamemos a esto `tile`)
          **->** crea un array con los 4 colores de paleta de ```javascript sprite.paletteId```
            (llamemos a esto `paletteColors`)
          **->** ```javascript for (let insideX = 0; insideX < 8; insideX++)```:
            **->** obtiene el Ã­ndice de color para este pÃ­xel usando `tile.getColorIndex(insideX)`
              (llamemos a esto `colorIndex`)
            **->** si ```javascript colorIndex > 0``` (es decir, el pÃ­xel no es transparente):
              **->** llama a ```javascript this.ppu.plot(...)``` para dibujar el pÃ­xel
  responses:
  - Â¿quÃ© pattern table deberÃ­a usar? [patterntable]
  - Â¿quÃ© id de tile deberÃ­a usar? [tileid]
  - Â¿cÃ³mo puedo obtener los colores de la paleta? [palette]
  - Â¿quÃ© ~X~ y ~Y~ deberÃ­a usar al dibujar pÃ­xeles? [coordinates]
  - Â¿quÃ© color deberÃ­a usar al dibujar pÃ­xeles? [color]

patterntable:
  messages:
  - Â¡pregÃºntale al sprite!
  - "```javascript sprite.patternTableId```"
  responses:
  - ...easy

tileid:
  messages:
  - Â¡el sprite sabe!
  - "```javascript sprite.tileIdFor(insideY)```"
  responses:
  - ...easy

palette:
  messages:
  - |-
    puedes obtener, por ejemplo, el <color 2> usando:
    ```javascript this.ppu.getColor(sprite.paletteId, 2)```
  responses:
  - ...easy

coordinates:
  messages:
  - la posiciÃ³n ~x~ deberÃ­a ser ```javascript sprite.x + insideX```
  - la posiciÃ³n ~y~ deberÃ­a ser la scanline actual
  responses:
  - ...easy

color:
  messages:
  - leer `paletteColors` con el `colorIndex` te darÃ¡ el ~color~
  responses:
  - ...easy
