---
main:
  messages:
  - âš ï¸  <Â¡Â¡Â¡ADVERTENCIA DE VOLUMEN!!!> âš ï¸
  - <asegÃºrate de que el volumen de tu dispositivo estÃ© muy bajo para que no te lastime los oÃ­dos>
  - Â¡hagamos algo de ruido!
  - primero, integrarÃ© tu ğŸ”Š  APU en el emulador
  responses:
  - adelante [integrate]

integrate:
  messages:
  - deberÃ­a ser rÃ¡pido...
  run-after-messages: |
    level.startEffect("earthquake");
    setTimeout(() => {
      bus.emit("patching-end");
    }, 500);
  events: 
  - patching-end [done]

done:
  run: |
    level.stopEffect();
    book.unlock("useAPU");
  messages:
  - âœ…  Â¡listo!
  - <! ğŸ”Š  APU integrada.
  - ahora, el Ã­cono ğŸ”Š  en el emulador brillarÃ¡ âœ¨
  - como casi no hay cÃ³digo APU, por ahora no tendremos sonido
  - Â¡pero ya llegaremos!
  - vamos a programar una <onda de ejemplo>
  responses:
  - Â¿como una onda cuadrada? â¹ï¸ [exercise]

exercise:
  messages:
  - Â¡correcto! actualmente, deberÃ­as tener algo como ```javascript onSample(this.sample)```
  - |-
    ğŸ“š  <antes> de esa llamada a `onSample(...)`, agrega:
      ```javascript
      // <test>
      this.time = (this.time || 0) + 1 / 44100;
      const frequency = 440;
      const period = 1 / frequency;
      const dutyCycle = 0.5;
      this.sample = (this.time % period) < period * dutyCycle ? 1 : 0;
      // </test>```
  - Â¡pruÃ©balo! al cargar una ROM, deberÃ­as escuchar una onda cuadrada tocando una nota <A4> (~440~ Hz) ğŸµ
  responses:
  - (*) Â¿quÃ© es el ciclo de trabajo? [duty]

duty:
  messages:
  - en una onda de pulso, el ciclo de trabajo define el porcentaje de tiempo que la seÃ±al estÃ¡ en <alto> (vs <bajo>)
  - por ejemplo, con un ciclo de trabajo del <50%>, pasa el mismo tiempo en ambos, y la llamamos onda cuadrada
  - <{wave_square.png;32x32}>
  - con un ciclo de trabajo del <25%>, se verÃ­a asÃ­
  - <{wave_square_25duty.png;32x32}>
  - y con <75%>
  - <{wave_square_75duty.png;32x32}>
  - Â¡todos suenan <muy diferentes>! prueba cambiar la constante `dutyCycle` para ver cÃ³mo reacciona
  responses:
  - ...exercise
