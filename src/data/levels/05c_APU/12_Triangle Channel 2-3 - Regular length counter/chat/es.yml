---
main:
  messages:
  - Â¿escuchaste el emulador? ðŸ˜‚
  - Â¡necesitamos silenciar estas ondas triangulares con urgencia!
  - "el Canal Triangular debe silenciarse:"
  - ðŸ“¡  cuando su timer estÃ¡ por debajo de 8 (ya cubierto âœ… )
  - ðŸ”‡  cuando los juegos silencian el canal con una escritura a ðŸŽ›ï¸  APUControl
  - ðŸ“  cuando su contador de longitud es 0
  - ðŸ“  cuando su contador lineal de longitud es 0
  responses:
  - (*) Â¿dos contadores de longitud? [two]
  - Â¿quÃ© hacemos? [exercise]

two:
  messages:
  - Â¡sÃ­!
  - el otro se comporta un poco diferente
  - Â¡mÃ¡s sobre eso despuÃ©s!
  responses: 
  - ...main

exercise:
  messages:
  - |-
    ðŸ“š  implementa en ðŸ“  `TriangleLengthControl`:
    **onLoad()**:
      **->** usa ```javascript this.addField(...)``` para definir un campo `halt` mapeado al bit 7
    **onWrite(value)**:
      **->** asigna el valor con ```javascript this.setValue(...)```
  - |-
    ðŸ“š  en ðŸ”º  `TriangleChannel`:
    **->** importa la clase ðŸ“  `LengthCounter` y agrega una propiedad `lengthCounter` con una nueva instancia
    **->** modifica **sample()** para que si ```javascript !this.isEnabled()``` o el contador de longitud no estÃ¡ activo, retorna la Ãºltima muestra generada sin cambiar nada
    **->** agrega los siguientes mÃ©todos:
    **quarterFrame()**:
      **[!]** dÃ©jalo vacÃ­o por ahora
    **halfFrame()**:
      **->** llama al mÃ©todo `clock(...)` del contador de longitud
        (usa ```javascript this.isEnabled()``` como primer argumento)
        (para la bandera de detenciÃ³n, usa la bandera `halt` que agregaste en el registro ðŸ“  TriangleLengthControl)
    **isEnabled()**:
      **->** retorna ```javascript !!this.apu.registers.apuControl.enableTriangle```
  - |-
    ðŸ“š  en ðŸ”Š  `APU`:
    **onQuarterFrameClock()**:
      **->** llama a `quarterFrame()` en la instancia del canal triangular
    **onHalfFrameClock()**:
      **->** llama a `halfFrame()` en la instancia del canal triangular
  - |-
    ðŸ“š  implementa en ðŸ•›  `TriangleTimerHighLCL`:
    **onLoad()**:
      **->** usa ```javascript this.addField(...)``` para definir un campo `lengthCounterLoad` de 5 bits desde el bit 3
    **onWrite(value)**:
      **->** __mantÃ©n el comportamiento existente__
      **->** determina la nueva longitud accediendo al array `noteLengths` con el Ã­ndice ```javascript this.lengthCounterLoad```
        (usa ðŸ“„  ~/lib/apu/noteLengths.js~ para obtener el array)
      **->** asigna el nuevo valor a la propiedad `counter` del contador de longitud
  - |-
    ðŸ“š  implementa en ðŸŽ›ï¸  `APUControl`:
    **onWrite(value)**:
      **->** __mantÃ©n el comportamiento existente__
      **->** si `!this.enableTriangle`:
        **->** reinicia el contador de longitud del canal
  responses: []
