---
main:
  messages:
  - el ðŸ’¥  Canal Ruido es un poco... <ruidoso>
  - silenciarlo correctamente es crucial, asÃ­ que empezaremos con eso
  - Â¡y solo entonces empezaremos con la emulaciÃ³n real del ruido!
  responses:
  - Â¿cÃ³mo lo silenciamos? [exercise]

exercise:
  messages:
  - como siempre, monitoreando ðŸŽ›ï¸  APUControl y el ðŸ“  contador de longitud
  - Â¡tambiÃ©n tiene una ðŸ“‰  envolvente! que veremos mÃ¡s adelante
  - a este punto, todo esto es material normal, asÃ­ que te darÃ© una plantilla base y tÃº conectarÃ¡s todo
  - ðŸ“š  crea una clase `NoiseChannel`, usando ðŸ“„  ~/tmpl/apu/NoiseChannel.js~ como plantilla
  - |-
    ðŸ“š  en ðŸ”Š  `APU`:
    **->** importa el canal y agrega una clave `noise` a ```javascript this.channels``` con una nueva instancia
    **->** en `step()`, antes de incrementar el contador de samples, llama a ```javascript this.channels.noise.step()```
    **->** tambiÃ©n en `step()`, agrega el canal ruido a la mezcla:
      ```javascript const noise = this.channels.noise.sample();
      this.sample = (pulse1 + pulse2 + triangle + noise) * 0.01;

      onSample(this.sample, pulse1, pulse2, triangle, noise);```
    **->** en `onQuarterFrameClock()`, llama a `quarterFrame()` en la instancia del canal ruido
    **->** en `onHalfFrameClock()`, llama a `halfFrame()` en la instancia del canal ruido
  - |-
      ðŸ“š  implementa en ðŸ’¥  `NoiseControl`:
      **onLoad()**:
        **->** usa ```javascript this.addField(...)``` para definir 3 campos: `volumeOrEnvelopePeriod`, `constantVolume`, `envelopeLoopOrLengthCounterHalt`
        (usa ðŸ“„  ~/docs/apu/audio_registers.es.md~ como referencia)
      **onWrite(value)**:
        **->** asigna el valor con ```javascript this.setValue(...)```
  - |-
      ðŸ“š  implementa en ðŸ“  `NoiseLCL`:
      **onLoad()**:
        **->** usa ```javascript this.addField(...)``` para definir un campo de 5 bits `lengthCounterLoad` desde el bit 3
      **onWrite(value)**:
        **->** __mantÃ©n el comportamiento existente__
        **->** determina la nueva longitud accediendo al array `noteLengths` con el Ã­ndice ```javascript this.lengthCounterLoad```
          (usa ðŸ“„  ~/lib/apu/noteLengths.js~ para obtener el array)
        **->** asigna el nuevo valor a la propiedad `counter` del contador de longitud
  - |-
    ðŸ“š  implementa en ðŸŽ›ï¸  `APUControl`:
    **onWrite(value)**:
      **->** __mantÃ©n el comportamiento existente__
      **->** si `!this.enableNoise`:
        **->** reinicia el contador de longitud del canal
  responses:
  - "(*) Â¿por quÃ© la plantilla que diste usa `Math.random()`? [random]"

random:
  messages:
  - bueno, obviamente eso no es lo que hace la NEEES
  - Â¡pero lo agreguÃ© solo para que puedas escuchar algo!
  - vamos a emular correctamente el ruido en el siguiente nivel
  responses:
  - ...exercise
