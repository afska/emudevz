---
main:
  run: |
    if (m.$end) $.goTo("refactor");
    else {
      set((m) => {
        m.chat.stopBlock = locales.get("not_now");
        m.$canRun = false;
        m.$canEdit = false;
      });
    }
  messages:
  - entonces, con el combo `LDA` + `STA` puedes escribir en memoria 锔
  - "hay instrucciones similares que usan los registros [X] e [Y]:"
  - "`LDX`, `STX`, `LDY` y `STY`"
  - ahora vamos a usar las variantes [X], solo por diversi贸n
  responses:
  - 驴qu茅 pasa si quiero <leer> de la memoria?  [read]

read:
  messages:
  - "puedes pasarle una direcci贸n de memoria a `LDX`, tan solo omitiendo el prefijo #"
  - p. ej. la instrucci贸n `LDX $4080` cargar谩 en [X] lo que sea que est茅 en la direcci贸n de memoria $4080
  responses:
  - 驴y despu茅s qu茅?  [then]

then:
  messages:
  - una vez que cargas algo en un registro, puedes hacer lo que t煤 quieras
  - algo com煤n es mutar el valor y copiarlo a otro registro
  - 隆o a otra ubicaci贸n de memoria! 
  - "`INX`, por ejemplo, incrementa el valor en [X]"
  responses:
  - 驴puedo probarlo? [tryit]

tryit:
  run-after-messages: |
    set((m) => m.$canRun = true);
  messages:
  - s铆, hay un $10 ya cargado en $4085
  - ejecuta el c贸digo actual y mira qu茅 ocurre
  events:
  - end [result]

result:
  messages:
  - 驴ves? el programa ley贸 ese $10
  - lo increment贸 3 veces
  - y escribi贸 el resultado en $4086 
  responses:
  - suena como mucho trabajo, 驴qu茅 pasa si quiero incrementarlo 8 veces? [8times]

8times:
  messages:
  - "en ese caso, escribes:"
  - INX
  - INX
  - INX
  - INX
  - INX
  - INX
  - INX
  - INX
  - nah, mentira 
  - hay una instrucci贸n para sumar
  - "puedes escribir `ADC #$08` para incrementar [A] ocho veces"
  responses:
  - uff  [iknow]
  - pero... [iknow]

iknow:
  run: |
    set((m) => m.$end = true);
  run-after-messages: |
    set((m) => {
      m.chat.stopBlock = null;
      m.$canEdit = true;
    });
  messages:
  - ya s茅, dije [A] en vez de [X]
  - "`ADC` solo funciona con [A] し"
  - mmm...
  - ...refactor
  responses:
  - ...refactor

refactor:
  messages:
  - vamos a refactorizar el c贸digo 
  - haz que use `ADC` en vez de 3 instrucciones de incremento
  - (recuerda reemplazar `LDX` y `STX` por `LDA` y `STA`)
  - cuando est茅 listo, ejecuta el comando `test`
  responses:
  - ok [end]
